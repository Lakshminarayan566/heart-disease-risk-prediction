<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BMI Calculator</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body class="health-gradient">
  <div class="floating-shapes">
    <div class="shape-1"></div>
    <div class="shape-2"></div>
    <div class="shape-3"></div>
    <div class="shape-4"></div>
  </div>

  <div class="container mx-auto px-4 py-8">
    <header class="mb-8 flex flex-col items-center">
      <div class="heart-beat-container animate__animated animate__fadeIn">
        <object type="image/svg+xml" data="{{ url_for('static', filename='images/heart_icon.svg') }}" class="w-16 h-16">Heart Icon</object>
      </div>
      <h1 class="text-4xl font-bold text-center text-white mt-4 animate__animated animate__fadeInDown">BMI Calculator</h1>
      <p class="text-xl text-white text-center mt-2 animate__animated animate__fadeIn">Calculate your Body Mass Index</p>
      
      <div class="w-8 h-1 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full mt-4"></div>
    </header>

    <div class="card-container animate__animated animate__fadeInUp">
      <div class="form-card">
        <div class="form-header">
          <h2 class="text-2xl font-bold">Enter Your Measurements</h2>
          <p class="text-sm opacity-80 mt-1">Fill in all fields for accurate calculation</p>
        </div>

        <form id="bmiForm" class="space-y-6 mt-6">
          <div class="grid md:grid-cols-2 gap-6">
            <!-- Height -->
            <div class="form-group hover-float">
              <label><i class="fas fa-ruler-vertical icon-prefix"></i> Height (cm)</label>
              <input type="number" name="height" required>
              <div class="input-highlight"></div>
            </div>

            <!-- Weight -->
            <div class="form-group hover-float">
              <label><i class="fas fa-weight icon-prefix"></i> Weight (kg)</label>
              <input type="number" name="weight" required>
              <div class="input-highlight"></div>
            </div>
          </div>

          <!-- Submit Button -->
          <div class="mt-8">
            <button type="submit" class="submit-btn hover-grow">
              <span class="btn-text">Calculate BMI</span>
              <i class="fas fa-calculator ml-2"></i>
              <div class="btn-loader hidden">
                <i class="fas fa-circle-notch fa-spin"></i>
              </div>
            </button>
          </div>
          
          <div class="mt-4 text-center">
            <a href="/" class="mini-button">
              <i class="fas fa-arrow-left"></i> Back to Heart Disease Risk Prediction
            </a>
          </div>
        </form>

        <!-- BMI Result -->
        <div id="bmiResult" class="result-section hidden animate__animated">
          <div class="result-header">
            <i class="fas fa-chart-pie text-4xl"></i>
            <h2 class="text-2xl font-bold">Your BMI Result</h2>
          </div>
          
          <div class="result-visual">
            <div class="bmi-scale">
              <div class="bmi-scale-bar">
                <div class="bmi-scale-pointer" id="bmiPointer"></div>
                <div class="bmi-scale-categories">
                  <div class="bmi-category">Underweight</div>
                  <div class="bmi-category">Normal</div>
                  <div class="bmi-category">Overweight</div>
                  <div class="bmi-category">Obese</div>
                </div>
              </div>
            </div>
            <div class="bmi-reading">
              <span id="bmiValue">0</span>
            </div>
          </div>
          
          <div class="risk-description">
            <p id="bmiCategory">Calculating...</p>
            <p id="bmiMessage" class="mt-2"></p>
          </div>
          
          <div class="health-tip mt-6 p-4 rounded-lg" style="background: rgba(255, 255, 255, 0.05);">
            <h3 class="font-bold text-lg mb-2"><i class="fas fa-lightbulb mr-2"></i> Health Tip</h3>
            <p id="healthTip">BMI is one measure of health, but it doesn't capture the full picture. Consider other factors like muscle mass, body composition, and overall lifestyle.</p>
          </div>
          
          <button onclick="resetBmiForm()" class="reset-btn mt-6">
            <i class="fas fa-redo mr-2"></i> Calculate Again
          </button>
        </div>
      </div>
    </div>

    <footer class="mt-12 text-center text-white animate__animated animate__fadeIn">
      <p>Â© 2023 Heart Health Predictor | For informational purposes only</p>
    </footer>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize animations
      initializeAnimations();
      
      // Handle form submission
      const bmiForm = document.getElementById('bmiForm');
      if (bmiForm) {
        bmiForm.addEventListener('submit', handleBmiFormSubmit);
      }
      
      // Add focus and blur event listeners to form inputs
      const formInputs = document.querySelectorAll('.form-group input, .form-group select');
      formInputs.forEach(input => {
        input.addEventListener('focus', handleInputFocus);
        input.addEventListener('blur', handleInputBlur);
      });
    });
    
    function initializeAnimations() {
      // Animate form fields on load
      gsap.from('.form-group', {
        y: 30,
        opacity: 0,
        duration: 0.8,
        stagger: 0.1,
        ease: 'power2.out',
        delay: 0.5
      });
      
      // Slow down the floating animation for input fields
      const floatingElements = document.querySelectorAll('.hover-float');
      floatingElements.forEach(element => {
        gsap.to(element, {
          y: -3, // Reduced movement
          duration: 3, // Slower animation
          repeat: -1,
          yoyo: true,
          ease: 'sine.inOut',
          delay: Math.random() * 2 // More varied delays
        });
      });
    }
    
    function handleInputFocus(e) {
      const formGroup = e.target.closest('.form-group');
      const highlight = formGroup.querySelector('.input-highlight');
      
      // Animate the highlight
      gsap.to(highlight, {
        width: '100%',
        duration: 0.3,
        ease: 'power2.out'
      });
    }
    
    function handleInputBlur(e) {
      const formGroup = e.target.closest('.form-group');
      const highlight = formGroup.querySelector('.input-highlight');
      
      // If input is empty, shrink the highlight
      if (!e.target.value) {
        gsap.to(highlight, {
          width: '0%',
          duration: 0.3,
          ease: 'power2.out'
        });
      }
    }
    
    function handleBmiFormSubmit(e) {
      e.preventDefault();
      
      // Show loading state
      const submitBtn = document.querySelector('.submit-btn');
      const btnText = submitBtn.querySelector('.btn-text');
      const btnLoader = submitBtn.querySelector('.btn-loader');
      
      btnText.style.opacity = '0.5';
      btnLoader.classList.remove('hidden');
      
      // Get form values
      const height = parseFloat(document.querySelector('input[name="height"]').value);
      const weight = parseFloat(document.querySelector('input[name="weight"]').value);
      
      // Calculate BMI
      // BMI = weight (kg) / (height (m) * height (m))
      const heightInMeters = height / 100;
      const bmi = weight / (heightInMeters * heightInMeters);
      
      // Reset button state
      setTimeout(() => {
        btnText.style.opacity = '1';
        btnLoader.classList.add('hidden');
        
        // Display result
        showBmiResult(bmi);
      }, 800);
    }
    
    function showBmiResult(bmi) {
      const resultSection = document.getElementById('bmiResult');
      const bmiForm = document.getElementById('bmiForm');
      const bmiValue = document.getElementById('bmiValue');
      const bmiPointer = document.getElementById('bmiPointer');
      
      // Round BMI to 1 decimal place
      const bmiRounded = Math.round(bmi * 10) / 10;
      
      // Show result section
      resultSection.classList.remove('hidden');
      resultSection.classList.add('animate__fadeIn');
      
      // Hide form
      gsap.to(bmiForm, {
        opacity: 0,
        height: 0,
        duration: 0.5,
        ease: 'power2.out',
        onComplete: () => {
          bmiForm.style.display = 'none';
          
          // Animate result appearance
          gsap.from('.result-header', {
            y: 30,
            opacity: 0,
            duration: 0.8,
            ease: 'power2.out'
          });
          
          gsap.from('.result-visual', {
            scale: 0.8,
            opacity: 0,
            duration: 0.8,
            delay: 0.3,
            ease: 'back.out(1.7)'
          });
          
          // Animate the BMI value
          gsap.to(bmiValue, {
            innerHTML: bmiRounded,
            duration: 1.5,
            snap: { innerHTML: 0.1 }
          });
          
          // Position the BMI pointer on the scale
          let pointerPosition = 0;
          if (bmiRounded < 18.5) {
            pointerPosition = bmiRounded / 18.5 * 25;
          } else if (bmiRounded < 25) {
            pointerPosition = 25 + ((bmiRounded - 18.5) / 6.5 * 25);
          } else if (bmiRounded < 30) {
            pointerPosition = 50 + ((bmiRounded - 25) / 5 * 25);
          } else {
            pointerPosition = 75 + Math.min(((bmiRounded - 30) / 10 * 25), 25);
          }
          
          bmiPointer.style.left = `${Math.min(pointerPosition, 98)}%`;
          
          // Set BMI category and message
          updateBmiCategory(bmiRounded);
        }
      });
    }
    
    function updateBmiCategory(bmi) {
      const bmiCategory = document.getElementById('bmiCategory');
      const bmiMessage = document.getElementById('bmiMessage');
      const healthTip = document.getElementById('healthTip');
      
      let category, message, tip, categoryClass;
      
      // Determine BMI category
      if (bmi < 18.5) {
        category = 'Underweight';
        message = 'Your BMI suggests you are underweight. Consider consulting with a healthcare provider.';
        tip = 'Focus on nutrient-dense foods and a balanced diet to gain weight in a healthy way.';
        categoryClass = 'text-blue-400';
      } else if (bmi < 25) {
        category = 'Normal Weight';
        message = 'Your BMI is within the normal range. Maintain your healthy habits!';
        tip = 'Continue eating a balanced diet and exercising regularly to maintain your healthy weight.';
        categoryClass = 'text-green-400';
      } else if (bmi < 30) {
        category = 'Overweight';
        message = 'Your BMI indicates you are overweight. Consider lifestyle changes to reduce health risks.';
        tip = 'Small changes like adding more physical activity and reducing processed foods can make a big difference.';
        categoryClass = 'text-yellow-400';
      } else {
        category = 'Obese';
        message = 'Your BMI indicates obesity, which increases risk for various health conditions.';
        tip = 'Consult with a healthcare provider for personalized advice on healthy weight management.';
        categoryClass = 'text-red-400';
      }
      
      // Update text content
      bmiCategory.textContent = `BMI Category: ${category}`;
      bmiCategory.className = categoryClass;
      bmiMessage.textContent = message;
      healthTip.textContent = tip;
      
      // Animate the message
      gsap.from(bmiMessage, {
        opacity: 0,
        y: 20,
        duration: 0.8,
        delay: 1,
        ease: 'power2.out'
      });
    }
    
    function resetBmiForm() {
      const bmiForm = document.getElementById('bmiForm');
      const resultSection = document.getElementById('bmiResult');
      
      // Hide result section with animation
      gsap.to(resultSection, {
        opacity: 0,
        y: 20,
        duration: 0.5,
        ease: 'power2.out',
        onComplete: () => {
          resultSection.classList.add('hidden');
          
          // Reset the actual form
          bmiForm.reset();
          
          // Show form again
          bmiForm.style.display = 'block';
          gsap.to(bmiForm, {
            opacity: 1,
            height: 'auto',
            duration: 0.5,
            ease: 'power2.out'
          });
          
          // Animate form fields
          gsap.from('.form-group', {
            y: 20,
            opacity: 0,
            duration: 0.5,
            stagger: 0.05,
            ease: 'power2.out',
            delay: 0.2
          });
        }
      });
    }
  </script>
  <script src="{{ url_for('static', filename='js/particles.js') }}"></script>
  
  <style>
    /* Specific styles for BMI calculator */
    .bmi-scale {
      width: 100%;
      height: 40px;
      margin: 30px 0;
      position: relative;
    }
    
    .bmi-scale-bar {
      width: 100%;
      height: 20px;
      background: linear-gradient(to right, 
        #3498db 0%, #3498db 25%, /* Underweight - blue */
        #2ecc71 25%, #2ecc71 50%, /* Normal - green */
        #f1c40f 50%, #f1c40f 75%, /* Overweight - yellow */
        #e74c3c 75%, #e74c3c 100% /* Obese - red */
      );
      border-radius: 10px;
      position: relative;
    }
    
    .bmi-scale-pointer {
      position: absolute;
      top: -10px;
      left: 50%;
      width: 4px;
      height: 40px;
      background-color: #fff;
      border-radius: 4px;
      transform: translateX(-50%);
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
      transition: left 1.5s cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    
    .bmi-scale-categories {
      display: flex;
      justify-content: space-between;
      width: 100%;
      margin-top: 10px;
    }
    
    .bmi-category {
      font-size: 0.75rem;
      color: rgba(255,255,255,0.8);
      width: 25%;
      text-align: center;
    }
    
    .bmi-reading {
      font-size: 2.5rem;
      font-weight: 700;
      text-align: center;
      margin: 20px 0;
      color: white;
    }
  </style>
</body>
</html>